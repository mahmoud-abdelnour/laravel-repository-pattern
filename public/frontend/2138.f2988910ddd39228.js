"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2138],{2138:(nt,T,a)=>{a.r(T),a.d(T,{UsersModule:()=>et});var d=a(6895),b=a(9197),f=a(2252),S=a(8674),c=a(4763),N=a(5033),m=a(1511),t=a(4650),y=a(9807),U=a(7392),g=a(4859);function J(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",1),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.parent.openPermissions(s.rowData))}),t.TgZ(1,"mat-icon",2),t._uU(2,"manage_accounts"),t.qZA()()}}function M(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",1),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.parent.openDialog(s.FormMode.Update,s.rowData))}),t.TgZ(1,"mat-icon",3),t._uU(2,"edit"),t.qZA()()}}function _(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",1),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.parent.popDelete(s.rowData))}),t.TgZ(1,"mat-icon",4),t._uU(2,"delete"),t.qZA()()}}let I=(()=>{class o{constructor(){this.FormMode=c.h}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-actions"]],hostAttrs:[1,"list-actions-btns"],decls:3,vars:3,consts:[["mat-button","",3,"click",4,"appPerm"],["mat-button","",3,"click"],[1,"permissions"],["color","primary"],["color","warn"]],template:function(e,n){1&e&&(t.YNc(0,J,3,0,"button",0),t.YNc(1,M,3,0,"button",0),t.YNc(2,_,3,0,"button",0)),2&e&&(t.Q6J("appPerm","edit_user"),t.xp6(1),t.Q6J("appPerm","edit_user"),t.xp6(1),t.Q6J("appPerm","delete_user"))},dependencies:[y.$,U.Hw,g.lW]}),o})();var h=a(7331);function D(o,i){if(1&o&&(t.TgZ(0,"mat-chip"),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}let w=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-roles-chips"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-chip-list"),t.YNc(1,D,2,1,"mat-chip",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",n.value))},dependencies:[d.sg,h.qn,h.HS],styles:["mat-chip.mat-chip.mat-standard-chip[_ngcontent-%COMP%]{border:1px solid #D0E0EB;background-color:#fff;color:var(--main-color)}"]}),o})();var p=a(5412),x=a(9242),L=a(2278),v=a(3416),P=a(8038),C=a(3546),R=a(4387),r=a(4006),O=a(8746),Q=a(8077),F=a(4115),Z=a(3848),A=a(6338);function Y(o,i){1&o&&(t.ynx(0),t.TgZ(1,"div",7)(2,"label",8),t._uU(3," \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 "),t.qZA(),t._UZ(4,"input",19),t.qZA(),t.TgZ(5,"div",7)(6,"label",8),t._uU(7," \u062a\u0623\u0643\u064a\u062f \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 "),t.qZA(),t._UZ(8,"input",20),t.qZA(),t.BQk())}function G(o,i){if(1&o&&(t.TgZ(0,"mat-list-option",21),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}let H=(()=>{class o{constructor(e){this.apiService=e,this.FormMode=c.h,this.isSaving=!1}ngOnInit(){this.form=new r.cw({name:new r.NI(null,r.kI.required),email:new r.NI(null,[r.kI.required,r.kI.email]),mobile:new r.NI(null,r.kI.required),national_id:new r.NI(null,r.kI.required),roles:new r.NI(null)}),this.mode==c.h.Create?(this.form.addControl("password",new r.NI(null,r.kI.required)),this.form.addControl("password_confirmation",new r.NI(null,r.kI.required)),this.form.addValidators([(0,Q.f)("password","password_confirmation")]),this.form.updateValueAndValidity()):(this.form.patchValue(this.data),this.form.controls.roles.patchValue(this.data.roles.map(e=>e.id)),this.mode==c.h.View&&this.form.disable()),this.apiService.get(m.A.provider.roles,{limit:!1}).subscribe(e=>{console.log("rr",e),this.roles=e.data})}save(){console.log(this.form),this.form.invalid||(this.isSaving=!0,(this.mode==c.h.Create?this.apiService.post(m.A.provider.users,this.form.value):this.apiService.put(`${m.A.provider.users}/${this.data.id}`,this.form.value)).pipe((0,O.x)(()=>this.isSaving=!1)).subscribe(n=>{console.log(n),this.ref.close(n)}))}changeTab(e){e.realignInkBar()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.s))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create"]],hostAttrs:[1,"app-dialog"],inputs:{data:"data",mode:"mode",ref:"ref"},decls:37,vars:15,consts:[[3,"formGroup","ngSubmit"],["mat-dialog-title",""],[1,"mat-typography"],["mat-align-tabs","start",3,"selectedTabChange"],["tabs",""],[3,"label"],[1,"row","mt-4"],[1,"col-md-6","mb-4","form-group"],["for",""],["formControlName","name","placeholder","\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"],["formControlName","email","placeholder","\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u0649"],["formControlName","national_id","placeholder","\u0627\u0644\u0647\u0648\u064a\u0629 \u0627\u0644\u0648\u0637\u0646\u064a\u0629"],["type","tel","formControlName","mobile","placeholder","\u0627\u0644\u062c\u0648\u0627\u0644"],[4,"ngIf"],["formControlName","roles",1,"mt-4"],["color","primary",3,"value",4,"ngFor","ngForOf"],["align","end",1,"actions"],["type","button","mat-button","","mat-dialog-close","",1,"cancel"],["mat-button","","cdkFocusInitial","",1,"save"],["type","password","formControlName","password","placeholder","\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"],["type","password","formControlName","password_confirmation","placeholder","\u062a\u0623\u0643\u064a\u062f \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"],["color","primary",3,"value"]],template:function(e,n){if(1&e){const s=t.EpF();t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.save()}),t.TgZ(1,"h2",1),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"mat-dialog-content",2)(6,"mat-tab-group",3,4),t.NdJ("selectedTabChange",function(){t.CHM(s);const l=t.MAs(7);return t.KtG(n.changeTab(l))}),t.TgZ(8,"mat-tab",5),t.ALo(9,"translate"),t.TgZ(10,"div",6)(11,"div",7)(12,"label",8),t._uU(13," \u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 "),t.qZA(),t._UZ(14,"input",9),t.qZA(),t.TgZ(15,"div",7)(16,"label",8),t._uU(17," \u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u0649 "),t.qZA(),t._UZ(18,"input",10),t.qZA(),t.TgZ(19,"div",7)(20,"label",8),t._uU(21," \u0627\u0644\u0647\u0648\u064a\u0629 \u0627\u0644\u0648\u0637\u0646\u064a\u0629 "),t.qZA(),t._UZ(22,"input",11),t.qZA(),t.TgZ(23,"div",7)(24,"label",8),t._uU(25," \u0627\u0644\u062c\u0648\u0627\u0644 "),t.qZA(),t._UZ(26,"input",12),t.qZA(),t.YNc(27,Y,9,0,"ng-container",13),t.qZA()(),t.TgZ(28,"mat-tab",5),t.ALo(29,"translate"),t.TgZ(30,"mat-selection-list",14),t.YNc(31,G,2,2,"mat-list-option",15),t.qZA()()()(),t.TgZ(32,"mat-dialog-actions",16)(33,"button",17),t._uU(34,"\u0625\u0644\u063a\u0627\u0621"),t.qZA(),t.TgZ(35,"button",18),t._uU(36," \u062d\u0641\u0638 "),t.qZA()()()}2&e&&(t.Q6J("formGroup",n.form),t.xp6(2),t.AsE(" ",t.lcZ(3,7,n.mode)," ",t.lcZ(4,9,"User")," "),t.xp6(6),t.Q6J("label",t.lcZ(9,11,"BasicInfo")),t.xp6(19),t.Q6J("ngIf",n.mode==n.FormMode.Create),t.xp6(1),t.Q6J("label",t.lcZ(29,13,"Roles")),t.xp6(3),t.Q6J("ngForOf",n.roles))},dependencies:[d.sg,d.O5,g.lW,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,p.ZT,p.uh,p.xY,p.H8,F.hL,F.J5,Z.SP,Z.uX,A.Ub,A.vS,v.X$],styles:["mat-selection-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}mat-selection-list[_ngcontent-%COMP%]     mat-list-option{width:50%!important;min-width:175px}mat-selection-list[_ngcontent-%COMP%]     mat-list-option .mat-list-item-content{flex-direction:row!important}mat-selection-list[_ngcontent-%COMP%]     mat-list-option .mat-list-item-content mat-pseudo-checkbox{margin-left:8px;margin-right:8px}mat-dialog-content[_ngcontent-%COMP%]{padding-top:0}mat-tab-body[_ngcontent-%COMP%]{padding:16px 0 0}"]}),o})();const E=["dialog"],$=["permissionDialog"],B=["table"];function j(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card-header")(1,"div",6),t._UZ(2,"div"),t.TgZ(3,"button",7),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.openDialog())}),t.TgZ(4,"mat-icon"),t._uU(5,"add"),t.qZA(),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"translate"),t.qZA()()()}2&o&&(t.xp6(6),t.AsE(" ",t.lcZ(7,2,"Create")," ",t.lcZ(8,4,"User")," "))}function X(o,i){if(1&o&&t._UZ(0,"app-create",8),2&o){const n=i.$implicit;t.Q6J("ref",i.dialogRef)("data",n.data)("mode",n.mode)}}function K(o,i){if(1&o&&t._UZ(0,"app-permissions",9),2&o){const e=i.dialogRef,n=i.$implicit,s=t.oxw();t.Q6J("ref",e)("data",n.data)("type",s.PermissionsType.user)}}const V=[{path:"list",component:(()=>{class o{constructor(e,n,s,u){this.matDialog=e,this.apiService=n,this.themeService=s,this.translateService=u,this.PermissionsType=N.Z,this.settings={columns:{name:{title:this.translateService.instant("Name"),type:f.Jm.Text,filter:!0},email:{title:this.translateService.instant("Email"),type:f.Jm.Text,filter:!0},roles:{title:this.translateService.instant("Role"),type:f.Jm.Custom,renderComponent:w,sort:!1,filter:!1,valuePrepareFunction:(l,it)=>l.map(ot=>ot.name)},actions:{title:this.translateService.instant("Options"),type:f.Jm.Custom,renderComponent:I,sort:!1,filter:!1,onComponentInitFunction:l=>l.parent=this}}},this.apiFunc=l=>this.apiService.get(m.A.provider.users,l)}ngOnInit(){}popDelete(e){this.rowToDelete=e.id,this.matDialog.open(S.F,{data:{parent:this}})}delete(){console.log("deleting user"),this.apiService.delete(m.A.provider.users+"/"+this.rowToDelete).subscribe(e=>{this.themeService.openSnackBar("DeleteSuccessMSG",null),this.table.reloadTable()})}openDialog(e=c.h.Create,n=null){this.matDialog.open(this.dialog,{data:{data:n,mode:e}}).afterClosed().subscribe(u=>{u&&this.table.reloadTable()})}openPermissions(e){this.matDialog.open(this.permissionDialog,{data:{data:e}}).afterClosed().subscribe(s=>{if(s){let u={...e,permissions:s,roles:e.roles.map(l=>l.id)};delete u.settings,this.apiService.put(`${m.A.provider.users}/${e.id}`,u).subscribe(l=>{this.themeService.openSnackBar("SavedSuccessfully",null),this.table.reloadTable()})}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.uw),t.Y36(x.s),t.Y36(L.f),t.Y36(v.sK))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list"]],viewQuery:function(e,n){if(1&e&&(t.Gf(E,5),t.Gf($,5),t.Gf(B,5)),2&e){let s;t.iGM(s=t.CRH())&&(n.dialog=s.first),t.iGM(s=t.CRH())&&(n.permissionDialog=s.first),t.iGM(s=t.CRH())&&(n.table=s.first)}},decls:13,vars:6,consts:[[1,"card-cont"],[4,"appPerm"],[3,"settings","apiFunc"],["table",""],["dialog",""],["permissionDialog",""],[1,"d-flex","align-items-center","justify-content-between"],["mat-raised-button","",1,"add-btn",3,"click"],[3,"ref","data","mode"],[3,"ref","data","type"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0)(1,"h2"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-card"),t.YNc(5,j,9,6,"mat-card-header",1),t.TgZ(6,"mat-card-content"),t._UZ(7,"app-table",2,3),t.qZA()()(),t.YNc(9,X,1,3,"ng-template",null,4,t.W1O),t.YNc(11,K,1,3,"ng-template",null,5,t.W1O)),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,4,"Users")," "),t.xp6(3),t.Q6J("appPerm","create_user"),t.xp6(2),t.Q6J("settings",n.settings)("apiFunc",n.apiFunc))},dependencies:[P.a,y.$,U.Hw,C.a8,C.dk,C.dn,g.lW,R.v,H,v.X$]}),o})()},{path:"",redirectTo:"list",pathMatch:"full"}];let W=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[b.Bz.forChild(V),b.Bz]}),o})();var q=a(5754),z=a(7084),k=a(6709),tt=a(154);let et=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[d.ez,W,q.m,Z.Nh,A.ie,z.To,k.p9,tt.S,h.Hi]}),o})()}}]);